<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xmlns:munit="http://www.mulesoft.org/schema/mule/munit" xmlns:munit-tools="http://www.mulesoft.org/schema/mule/munit-tools"
	xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
	xsi:schemaLocation="
		http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
		http://www.mulesoft.org/schema/mule/munit http://www.mulesoft.org/schema/mule/munit/current/mule-munit.xsd
		http://www.mulesoft.org/schema/mule/munit-tools  http://www.mulesoft.org/schema/mule/munit-tools/current/mule-munit-tools.xsd">
	
	<munit:config name="shipping-company-routing-test-suite.xml" />
	
	<!-- ========================================== -->
	<!-- 配送会社判別サブフローのテストケース -->
	<!-- ========================================== -->
	
	<!-- テストケース1: コニポス変更 - ゆうパケット→コニポス（関東センター） -->
	<munit:test name="shipping-company-routing-subflow-konipo-change-test" doc:id="test-konipo-change">
		<munit:execution>
			<set-payload value='{
				"shippingCompanyCode": "05",
				"shippingCompanyDetailCode": "054",
				"shippingCompanyFixedFlag": "0",
				"deliveryTimeCode": "",
				"deliveryTimeName": "",
				"deliveryDesignatedDate": "0",
				"destinationPrefecture": "東京都"
			}' />
			<set-variable value="KANTO_CENTER" variableName="distributionCenterResult" />
			<set-variable value="NM12345" variableName="tagNumber" />
			<flow-ref name="shipping-company-routing-subflow" />
		</munit:execution>
		<munit:validation>
			<munit-tools:assert-equals actual="#[vars.shippingCompanyCode]" expected="07" />
			<munit-tools:assert-equals actual="#[vars.shippingCompanyDetailCode]" expected="073" />
			<munit-tools:assert-equals actual="#[vars.shippingCompany]" expected="コニポス" />
		</munit:validation>
	</munit:test>
	
	<!-- テストケース2: JP時間帯変更 - 20-21時廃止対応 -->
	<munit:test name="shipping-company-routing-subflow-jp-time-change-test" doc:id="test-jp-time-change">
		<munit:execution>
			<set-payload value='{
				"shippingCompanyCode": "05",
				"shippingCompanyDetailCode": "050",
				"shippingCompanyFixedFlag": "0",
				"deliveryTimeCode": "06",
				"deliveryTimeName": "20時～21時",
				"deliveryDesignatedDate": "0",
				"destinationPrefecture": "東京都"
			}' />
			<set-variable value="CHUBU_CENTER" variableName="distributionCenterResult" />
			<set-variable value="NM12345" variableName="tagNumber" />
			<flow-ref name="shipping-company-routing-subflow" />
		</munit:execution>
		<munit:validation>
			<munit-tools:assert-equals actual="#[vars.deliveryTimeCode]" expected="08" />
			<munit-tools:assert-equals actual="#[vars.deliveryTimeName]" expected="19時～21時" />
			<munit-tools:assert-equals actual="#[vars.shippingCompany]" expected="日本郵便" />
		</munit:validation>
	</munit:test>
	
	<!-- テストケース3: 佐川変更 - ゆうパック→佐川（一般地域） -->
	<munit:test name="shipping-company-routing-subflow-sagawa-change-general-test" doc:id="test-sagawa-change-general">
		<munit:execution>
			<set-payload value='{
				"shippingCompanyCode": "05",
				"shippingCompanyDetailCode": "050",
				"shippingCompanyFixedFlag": "0",
				"deliveryTimeCode": "",
				"deliveryTimeName": "",
				"deliveryDesignatedDate": "0",
				"destinationPrefecture": "愛知県"
			}' />
			<set-variable value="CHUBU_CENTER" variableName="distributionCenterResult" />
			<set-variable value="NM12345" variableName="tagNumber" />
			<flow-ref name="shipping-company-routing-subflow" />
		</munit:execution>
		<munit:validation>
			<munit-tools:assert-equals actual="#[vars.shippingCompanyCode]" expected="02" />
			<munit-tools:assert-equals actual="#[vars.shippingCompanyDetailCode]" expected="020" />
			<munit-tools:assert-equals actual="#[vars.shippingCompany]" expected="佐川急便" />
		</munit:validation>
	</munit:test>
	
	<!-- テストケース4: 佐川変更 - ゆうパック→佐川（一般地域、時間帯変更あり） -->
	<munit:test name="shipping-company-routing-subflow-sagawa-change-with-time-test" doc:id="test-sagawa-change-with-time">
		<munit:execution>
			<set-payload value='{
				"shippingCompanyCode": "05",
				"shippingCompanyDetailCode": "050",
				"shippingCompanyFixedFlag": "0",
				"deliveryTimeCode": "06",
				"deliveryTimeName": "20時～21時",
				"deliveryDesignatedDate": "0",
				"destinationPrefecture": "大阪府"
			}' />
			<set-variable value="KANSAI_CENTER" variableName="distributionCenterResult" />
			<set-variable value="NM12345" variableName="tagNumber" />
			<flow-ref name="shipping-company-routing-subflow" />
		</munit:execution>
		<munit:validation>
			<munit-tools:assert-equals actual="#[vars.shippingCompanyCode]" expected="02" />
			<munit-tools:assert-equals actual="#[vars.shippingCompanyDetailCode]" expected="020" />
			<munit-tools:assert-equals actual="#[vars.shippingCompany]" expected="佐川急便" />
			<munit-tools:assert-equals actual="#[vars.deliveryTimeCode]" expected="08" />
			<munit-tools:assert-equals actual="#[vars.deliveryTimeName]" expected="19時～21時" />
		</munit:validation>
	</munit:test>
	
	<!-- テストケース5: 佐川変更 - 特別地域でお届け指定日=0 -->
	<munit:test name="shipping-company-routing-subflow-sagawa-change-special-area-test" doc:id="test-sagawa-change-special-area">
		<munit:execution>
			<set-payload value='{
				"shippingCompanyCode": "05",
				"shippingCompanyDetailCode": "050",
				"shippingCompanyFixedFlag": "0",
				"deliveryTimeCode": "",
				"deliveryTimeName": "",
				"deliveryDesignatedDate": "0",
				"destinationPrefecture": "北海道"
			}' />
			<set-variable value="HOKKAIDO_CENTER" variableName="distributionCenterResult" />
			<set-variable value="NM12345" variableName="tagNumber" />
			<flow-ref name="shipping-company-routing-subflow" />
		</munit:execution>
		<munit:validation>
			<munit-tools:assert-equals actual="#[vars.shippingCompanyCode]" expected="02" />
			<munit-tools:assert-equals actual="#[vars.shippingCompanyDetailCode]" expected="020" />
			<munit-tools:assert-equals actual="#[vars.shippingCompany]" expected="佐川急便" />
		</munit:validation>
	</munit:test>
	
	<!-- テストケース6: 佐川変更 - 特別地域でお届け指定日=0、時間帯変更あり -->
	<munit:test name="shipping-company-routing-subflow-sagawa-change-special-area-with-time-test" doc:id="test-sagawa-change-special-area-with-time">
		<munit:execution>
			<set-payload value='{
				"shippingCompanyCode": "05",
				"shippingCompanyDetailCode": "050",
				"shippingCompanyFixedFlag": "0",
				"deliveryTimeCode": "06",
				"deliveryTimeName": "20時～21時",
				"deliveryDesignatedDate": "0",
				"destinationPrefecture": "秋田県"
			}' />
			<set-variable value="HOKKAIDO_CENTER" variableName="distributionCenterResult" />
			<set-variable value="NM12345" variableName="tagNumber" />
			<flow-ref name="shipping-company-routing-subflow" />
		</munit:execution>
		<munit:validation>
			<munit-tools:assert-equals actual="#[vars.shippingCompanyCode]" expected="02" />
			<munit-tools:assert-equals actual="#[vars.shippingCompanyDetailCode]" expected="020" />
			<munit-tools:assert-equals actual="#[vars.shippingCompany]" expected="佐川急便" />
			<munit-tools:assert-equals actual="#[vars.deliveryTimeCode]" expected="08" />
			<munit-tools:assert-equals actual="#[vars.deliveryTimeName]" expected="19時～21時" />
		</munit:validation>
	</munit:test>
	
	<!-- テストケース7: ゆうパック維持 - 特別地域でお届け指定日≠0 -->
	<munit:test name="shipping-company-routing-subflow-keep-japan-post-special-area-test" doc:id="test-keep-japan-post-special-area">
		<munit:execution>
			<set-payload value='{
				"shippingCompanyCode": "05",
				"shippingCompanyDetailCode": "050",
				"shippingCompanyFixedFlag": "0",
				"deliveryTimeCode": "",
				"deliveryTimeName": "",
				"deliveryDesignatedDate": "1",
				"destinationPrefecture": "広島県"
			}' />
			<set-variable value="CHUGOKU_CENTER" variableName="distributionCenterResult" />
			<set-variable value="NM12345" variableName="tagNumber" />
			<flow-ref name="shipping-company-routing-subflow" />
		</munit:execution>
		<munit:validation>
			<munit-tools:assert-equals actual="#[vars.shippingCompany]" expected="日本郵便" />
		</munit:validation>
	</munit:test>
	
	<!-- テストケース8: 配送会社固定 - 佐川急便 -->
	<munit:test name="shipping-company-routing-subflow-fixed-sagawa-test" doc:id="test-fixed-sagawa">
		<munit:execution>
			<set-payload value='{
				"shippingCompanyCode": "02",
				"shippingCompanyDetailCode": "020",
				"shippingCompanyFixedFlag": "1",
				"deliveryTimeCode": "",
				"deliveryTimeName": "",
				"deliveryDesignatedDate": "0",
				"destinationPrefecture": "東京都"
			}' />
			<set-variable value="KANTO_CENTER" variableName="distributionCenterResult" />
			<set-variable value="NM12345" variableName="tagNumber" />
			<flow-ref name="shipping-company-routing-subflow" />
		</munit:execution>
		<munit:validation>
			<munit-tools:assert-equals actual="#[vars.shippingCompany]" expected="佐川急便" />
		</munit:validation>
	</munit:test>
	
	<!-- テストケース9: 配送会社固定 - ヤマト運輸 -->
	<munit:test name="shipping-company-routing-subflow-fixed-yamato-test" doc:id="test-fixed-yamato">
		<munit:execution>
			<set-payload value='{
				"shippingCompanyCode": "04",
				"shippingCompanyDetailCode": "040",
				"shippingCompanyFixedFlag": "1",
				"deliveryTimeCode": "",
				"deliveryTimeName": "",
				"deliveryDesignatedDate": "0",
				"destinationPrefecture": "東京都"
			}' />
			<set-variable value="KANTO_CENTER" variableName="distributionCenterResult" />
			<set-variable value="NM12345" variableName="tagNumber" />
			<flow-ref name="shipping-company-routing-subflow" />
		</munit:execution>
		<munit:validation>
			<munit-tools:assert-equals actual="#[vars.shippingCompany]" expected="ヤマト運輸" />
		</munit:validation>
	</munit:test>
	
	<!-- テストケース10: 配送会社固定 - 日本郵便 -->
	<munit:test name="shipping-company-routing-subflow-fixed-japan-post-test" doc:id="test-fixed-japan-post">
		<munit:execution>
			<set-payload value='{
				"shippingCompanyCode": "05",
				"shippingCompanyDetailCode": "050",
				"shippingCompanyFixedFlag": "1",
				"deliveryTimeCode": "",
				"deliveryTimeName": "",
				"deliveryDesignatedDate": "0",
				"destinationPrefecture": "東京都"
			}' />
			<set-variable value="KANTO_CENTER" variableName="distributionCenterResult" />
			<set-variable value="NM12345" variableName="tagNumber" />
			<flow-ref name="shipping-company-routing-subflow" />
		</munit:execution>
		<munit:validation>
			<munit-tools:assert-equals actual="#[vars.shippingCompany]" expected="日本郵便" />
		</munit:validation>
	</munit:test>
	
	<!-- テストケース11: 配送会社固定 - コニポス -->
	<munit:test name="shipping-company-routing-subflow-fixed-konipo-test" doc:id="test-fixed-konipo">
		<munit:execution>
			<set-payload value='{
				"shippingCompanyCode": "07",
				"shippingCompanyDetailCode": "073",
				"shippingCompanyFixedFlag": "1",
				"deliveryTimeCode": "",
				"deliveryTimeName": "",
				"deliveryDesignatedDate": "0",
				"destinationPrefecture": "東京都"
			}' />
			<set-variable value="KANTO_CENTER" variableName="distributionCenterResult" />
			<set-variable value="NM12345" variableName="tagNumber" />
			<flow-ref name="shipping-company-routing-subflow" />
		</munit:execution>
		<munit:validation>
			<munit-tools:assert-equals actual="#[vars.shippingCompany]" expected="コニポス" />
		</munit:validation>
	</munit:test>
	
	<!-- テストケース12: 配送会社固定 - その他配送会社 -->
	<munit:test name="shipping-company-routing-subflow-fixed-other-test" doc:id="test-fixed-other">
		<munit:execution>
			<set-payload value='{
				"shippingCompanyCode": "99",
				"shippingCompanyDetailCode": "990",
				"shippingCompanyFixedFlag": "1",
				"deliveryTimeCode": "",
				"deliveryTimeName": "",
				"deliveryDesignatedDate": "0",
				"destinationPrefecture": "東京都"
			}' />
			<set-variable value="KANTO_CENTER" variableName="distributionCenterResult" />
			<set-variable value="NM12345" variableName="tagNumber" />
			<flow-ref name="shipping-company-routing-subflow" />
		</munit:execution>
		<munit:validation>
			<munit-tools:assert-equals actual="#[vars.shippingCompany]" expected="その他配送会社" />
		</munit:validation>
	</munit:test>
	
	<!-- テストケース13: 荷札番号による特別判定 - SP（佐川急便） -->
	<munit:test name="shipping-company-routing-subflow-special-tag-sp-test" doc:id="test-special-tag-sp">
		<munit:execution>
			<set-payload value='{
				"shippingCompanyCode": "05",
				"shippingCompanyDetailCode": "050",
				"shippingCompanyFixedFlag": "0",
				"deliveryTimeCode": "",
				"deliveryTimeName": "",
				"deliveryDesignatedDate": "0",
				"destinationPrefecture": "東京都"
			}' />
			<set-variable value="KANTO_CENTER" variableName="distributionCenterResult" />
			<set-variable value="SP12345" variableName="tagNumber" />
			<flow-ref name="shipping-company-routing-subflow" />
		</munit:execution>
		<munit:validation>
			<munit-tools:assert-equals actual="#[vars.shippingCompanyCode]" expected="02" />
			<munit-tools:assert-equals actual="#[vars.shippingCompanyDetailCode]" expected="020" />
			<munit-tools:assert-equals actual="#[vars.shippingCompany]" expected="佐川急便" />
		</munit:validation>
	</munit:test>
	
	<!-- テストケース14: 荷札番号による特別判定 - EX（ヤマト運輸） -->
	<munit:test name="shipping-company-routing-subflow-special-tag-ex-test" doc:id="test-special-tag-ex">
		<munit:execution>
			<set-payload value='{
				"shippingCompanyCode": "05",
				"shippingCompanyDetailCode": "050",
				"shippingCompanyFixedFlag": "0",
				"deliveryTimeCode": "",
				"deliveryTimeName": "",
				"deliveryDesignatedDate": "0",
				"destinationPrefecture": "東京都"
			}' />
			<set-variable value="KANTO_CENTER" variableName="distributionCenterResult" />
			<set-variable value="EX67890" variableName="tagNumber" />
			<flow-ref name="shipping-company-routing-subflow" />
		</munit:execution>
		<munit:validation>
			<munit-tools:assert-equals actual="#[vars.shippingCompanyCode]" expected="04" />
			<munit-tools:assert-equals actual="#[vars.shippingCompanyDetailCode]" expected="040" />
			<munit-tools:assert-equals actual="#[vars.shippingCompany]" expected="ヤマト運輸" />
		</munit:validation>
	</munit:test>
	
	<!-- テストケース15: 荷札番号による特別判定 - FR（日本通運） -->
	<munit:test name="shipping-company-routing-subflow-special-tag-fr-test" doc:id="test-special-tag-fr">
		<munit:execution>
			<set-payload value='{
				"shippingCompanyCode": "05",
				"shippingCompanyDetailCode": "050",
				"shippingCompanyFixedFlag": "0",
				"deliveryTimeCode": "",
				"deliveryTimeName": "",
				"deliveryDesignatedDate": "0",
				"destinationPrefecture": "東京都"
			}' />
			<set-variable value="KANTO_CENTER" variableName="distributionCenterResult" />
			<set-variable value="FR11111" variableName="tagNumber" />
			<flow-ref name="shipping-company-routing-subflow" />
		</munit:execution>
		<munit:validation>
			<munit-tools:assert-equals actual="#[vars.shippingCompanyCode]" expected="06" />
			<munit-tools:assert-equals actual="#[vars.shippingCompanyDetailCode]" expected="060" />
			<munit-tools:assert-equals actual="#[vars.shippingCompany]" expected="日本通運" />
		</munit:validation>
	</munit:test>
	
	<!-- テストケース16: 荷札番号による特別判定 - DG（西濃運輸） -->
	<munit:test name="shipping-company-routing-subflow-special-tag-dg-test" doc:id="test-special-tag-dg">
		<munit:execution>
			<set-payload value='{
				"shippingCompanyCode": "05",
				"shippingCompanyDetailCode": "050",
				"shippingCompanyFixedFlag": "0",
				"deliveryTimeCode": "",
				"deliveryTimeName": "",
				"deliveryDesignatedDate": "0",
				"destinationPrefecture": "東京都"
			}' />
			<set-variable value="KANTO_CENTER" variableName="distributionCenterResult" />
			<set-variable value="DG22222" variableName="tagNumber" />
			<flow-ref name="shipping-company-routing-subflow" />
		</munit:execution>
		<munit:validation>
			<munit-tools:assert-equals actual="#[vars.shippingCompanyCode]" expected="03" />
			<munit-tools:assert-equals actual="#[vars.shippingCompanyDetailCode]" expected="030" />
			<munit-tools:assert-equals actual="#[vars.shippingCompany]" expected="西濃運輸" />
		</munit:validation>
	</munit:test>
	
	<!-- テストケース17: デフォルト処理 - 北海道センター（佐川急便） -->
	<munit:test name="shipping-company-routing-subflow-default-hokkaido-test" doc:id="test-default-hokkaido">
		<munit:execution>
			<set-payload value='{
				"shippingCompanyCode": "05",
				"shippingCompanyDetailCode": "050",
				"shippingCompanyFixedFlag": "0",
				"deliveryTimeCode": "",
				"deliveryTimeName": "",
				"deliveryDesignatedDate": "0",
				"destinationPrefecture": "東京都"
			}' />
			<set-variable value="HOKKAIDO_CENTER" variableName="distributionCenterResult" />
			<set-variable value="NM12345" variableName="tagNumber" />
			<flow-ref name="shipping-company-routing-subflow" />
		</munit:execution>
		<munit:validation>
			<munit-tools:assert-equals actual="#[vars.shippingCompanyCode]" expected="02" />
			<munit-tools:assert-equals actual="#[vars.shippingCompanyDetailCode]" expected="020" />
			<munit-tools:assert-equals actual="#[vars.shippingCompany]" expected="佐川急便" />
		</munit:validation>
	</munit:test>
	
	<!-- テストケース18: デフォルト処理 - 関東センター（ヤマト運輸） -->
	<munit:test name="shipping-company-routing-subflow-default-kanto-test" doc:id="test-default-kanto">
		<munit:execution>
			<set-payload value='{
				"shippingCompanyCode": "05",
				"shippingCompanyDetailCode": "050",
				"shippingCompanyFixedFlag": "0",
				"deliveryTimeCode": "",
				"deliveryTimeName": "",
				"deliveryDesignatedDate": "0",
				"destinationPrefecture": "東京都"
			}' />
			<set-variable value="KANTO_CENTER" variableName="distributionCenterResult" />
			<set-variable value="NM12345" variableName="tagNumber" />
			<flow-ref name="shipping-company-routing-subflow" />
		</munit:execution>
		<munit:validation>
			<munit-tools:assert-equals actual="#[vars.shippingCompanyCode]" expected="04" />
			<munit-tools:assert-equals actual="#[vars.shippingCompanyDetailCode]" expected="040" />
			<munit-tools:assert-equals actual="#[vars.shippingCompany]" expected="ヤマト運輸" />
		</munit:validation>
	</munit:test>
	
	<!-- テストケース19: デフォルト処理 - その他センター（日本郵便） -->
	<munit:test name="shipping-company-routing-subflow-default-other-center-test" doc:id="test-default-other-center">
		<munit:execution>
			<set-payload value='{
				"shippingCompanyCode": "05",
				"shippingCompanyDetailCode": "050",
				"shippingCompanyFixedFlag": "0",
				"deliveryTimeCode": "",
				"deliveryTimeName": "",
				"deliveryDesignatedDate": "0",
				"destinationPrefecture": "東京都"
			}' />
			<set-variable value="CHUBU_CENTER" variableName="distributionCenterResult" />
			<set-variable value="NM12345" variableName="tagNumber" />
			<flow-ref name="shipping-company-routing-subflow" />
		</munit:execution>
		<munit:validation>
			<munit-tools:assert-equals actual="#[vars.shippingCompanyCode]" expected="05" />
			<munit-tools:assert-equals actual="#[vars.shippingCompanyDetailCode]" expected="050" />
			<munit-tools:assert-equals actual="#[vars.shippingCompany]" expected="日本郵便" />
		</munit:validation>
	</munit:test>

</mule>
